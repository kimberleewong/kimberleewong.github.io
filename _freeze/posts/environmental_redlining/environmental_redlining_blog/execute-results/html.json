{
  "hash": "5b0a3edc4d9b775fad5a2e0ace77cb26",
  "result": {
    "markdown": "---\ntitle: \"Environmental Redlining\"\ndescription: \"Exploring patterns of environmental justice\"\nauthor:\n  - name: Kimmy Wong\n    url: https://kimberleewong.github.io/\n    affiliation: MEDS \n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science\ndate: 2024-12-07\nexecute: \n  warning: false\n  message: false\ncategories: [R, MEDS, Spatial-Analysis, Quarto]\ncitation: \n  url: https://kimberleewong.github.io/posts/environmental_redlining/environmental_redlining_blog.html\ntoc: true\nimage: redlining.jpg\ndraft: false\n---\n\n\n# Part 1: Legacy of redlining in current environmental (in)justice\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(tmap)\nlibrary(here)\nlibrary(kableExtra)\n```\n:::\n\n\n## Import Data\n\n1.  Import the redlining and ejscreen vector data.\n\n\n::: {.cell quiet='true'}\n\n```{.r .cell-code}\nejscreen <- st_read(here(\"posts\",\"environmental_redlining\", \"data\", \"ejscreen\",\"EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb\"))\n\nholc <- st_read(here(\"posts\",\"environmental_redlining\",\"data\", \"mapping-inequality\", \"mapping-inequality-los-angeles.json\")) %>% \n  filter(st_is_valid(.))\n```\n:::\n\n\n## Visualize data\n\n2.  Filter the ejscreen data for the table and visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for just California for a basemap\ncalifornia <- ejscreen %>%\n  dplyr::filter(ST_ABBREV == \"CA\" & ID != \"060379903000\" & ID != \"060379902000\") %>% \n  janitor::clean_names()\n\n# Filter to specifically LA to make the table \nlos_angeles <- california %>%\n  dplyr::filter(cnty_name %in% c(\"Los Angeles County\"))\n```\n:::\n\n\n3.  Check if the coordinate systems match between the ejscreen and redlining data. If they don't, fix it.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Do the coordinate systems match?\nst_crs(los_angeles) == st_crs(holc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\n# Transform the holc to match the ejscreen LA data\nholc_transform <- st_transform(holc, crs = st_crs(los_angeles))\n\n# Check to see if it worked\nif(st_crs(holc_transform) == st_crs(los_angeles)){\n  print(\"it's a match!\")\n} else {\n  print(\"still not a match\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"it's a match!\"\n```\n:::\n:::\n\n\n4.  Produce a map of historical redlining in Los Angeles, California, colored by the grades.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\ntm_shape(california, bbox = holc_transform) +\n  tm_polygons(col = \"beige\", border.alpha = 0) +\ntm_shape(holc_transform) +\n  tm_fill(\"grade\",\n          palette = c(\"A\" = \"palegreen3\",\n                      \"B\" = \"skyblue1\",\n                      \"C\" = \"lightgoldenrod\",\n                      \"D\" = \"tomato\"),\n          title = \"HOLC Grades\") +\ntm_shape(california, bbox = holc_transform) +\n  tm_borders(lwd = 0.3, col = \"black\", alpha = 0.6) + tm_scale_bar(position = c(\"right\", \"top\")) +\ntm_layout(frame = TRUE,\n          main.title = \"Home Owners' Loan Corporation \\n Grades in Los Angeles County, California\",\n          main.title.position = c(\"center\", \"top\"),\n          main.title.size = 1,\n          legend.outside = TRUE,\n          legend.outside.position = \"right\",\n          bg.color = \"skyblue3\") +\ntm_compass(position = c(\"left\", \"bottom\"),\n           size = 1) +\ntm_credits(\"Pacific Ocean\", col = \"black\", position = c(0.016, .18))\n```\n\n::: {.cell-output-display}\n![](environmental_redlining_blog_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n5.  Produce a table summarizing the percent of HOLC Grades in LA County.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nholc_ej <- st_join(holc_transform, los_angeles, join = st_intersects) %>% \n  group_by(grade)\n\ncensus <- holc_ej %>% \n  summarize(percent = n()/nrow(los_angeles)*100) %>% \n  select(grade, percent) %>% \n  st_drop_geometry\n\nkableExtra::kable(census, \n  col.names = c('Grade', 'Percentage'),\n  caption = \"Percentage of Census Block Groups by HOLC Grade\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Percentage of Census Block Groups by HOLC Grade</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Grade </th>\n   <th style=\"text-align:right;\"> Percentage </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 6.814388 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 18.303233 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 41.705873 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 19.729853 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 4.492336 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n6.  Check if there are any NAs to remove in the three variables that were requested (low income percent, pm2.5 percentile, and low life expectancy percentile)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (sum(is.na(holc_ej$lowincpct)) > 0) {\n  warning(\"There are NAs, better take them out!\")\n} else {\n  print(\"All good!\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"All good!\"\n```\n:::\n\n```{.r .cell-code}\nif (sum(is.na(holc_ej$p_pm25)) > 0) {\n  warning(\"There are NAs, better take them out!\")\n} else {\n  print(\"All good!\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"All good!\"\n```\n:::\n\n```{.r .cell-code}\nif (sum(is.na(holc_ej$p_lifeexppct)) > 0) {\n  warning(\"There are NAs, better take them out!\")\n} else {\n  print(\"All good!\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There are NAs, better take them out!\n```\n:::\n:::\n\n\n7.  \n\n    (a) Produce bar plot showing low income household against HOLC grades.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nlow_inc <- holc_ej %>% \n  group_by(grade) %>% \n  summarise(low_inc_percent = mean(lowincpct)) %>% \n  select(grade, low_inc_percent) %>% \n  st_drop_geometry()\n\nggplot(low_inc) +\n  geom_col(aes(x = grade, y = low_inc_percent),\n           fill = c(\"palegreen3\", \"skyblue1\", \"lightgoldenrod\", \"tomato\", \"grey\")) +\n  labs(x = \"HOLC Grade\",\n       y = \"Mean Low Income Household (%)\",\n       title = \"Percent of Low Income Households by HOLC Grade\")\n```\n\n::: {.cell-output-display}\n![](environmental_redlining_blog_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n7.  \n\n    (b) Produce bar plot showing pm 2.5 percentile against HOLC grades.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\npm25 <- holc_ej %>% \n  group_by(grade) %>% \n  summarise(pm_25 = mean(p_pm25)) %>% \n  select(grade, pm_25) %>% \n  st_drop_geometry()\n\nggplot(pm25) +\n  geom_col(aes(x = grade, y = pm_25),\n           fill = c(\"palegreen3\", \"skyblue1\", \"lightgoldenrod\", \"tomato\", \"grey\")) +\n  labs(x = \"HOLC Grade\",\n       y = \"Mean PM 2.5 Percentile\",\n       title = \"PM 2.5 Percentile by HOLC Grade\")\n```\n\n::: {.cell-output-display}\n![](environmental_redlining_blog_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n7.  \n\n    (c) Produce bar plot showing low life expectancy percentile against HOLC grades.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nlow_life <- holc_ej %>% \n  group_by(grade) %>% \n  summarise(low_life_expectancy = mean(p_lifeexppct, na.rm = TRUE)) %>% \n  select(grade, low_life_expectancy) %>% \n  st_drop_geometry()\n# dropped NAs in order to calculate the mean\n\nggplot(low_life) +\n  geom_col(aes(x = grade, y = low_life_expectancy),\n           fill = c(\"palegreen3\", \"skyblue1\", \"lightgoldenrod\", \"tomato\", \"grey\")) +\n  labs(x = \"HOLC Grade\",\n       y = \"Mean Low Life Expectancy Percentile\",\n       title = \"Low Life Expectancy Percentile by HOLC Grade\")\n```\n\n::: {.cell-output-display}\n![](environmental_redlining_blog_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## Conclusion\n\nAfter reviewing the results of the map, table, and three figures, there are a few interesting aspects that stick out to me. For one, there are far more 'C' graded regions than anything else, but the figure show that there is more low income households, PM 2.5 (by a small margin), and low life expectancy in the 'D' areas. This is interesting because it means those factors are heavily dense in the 'D' regions even if it less than double the size of 'C'. The map also shows that the grades are relatively spread out, and the grades are not just in four quadrants. I also noticed that my undergrad university (UCLA) is located in an 'A' area which makes sense because the surrrounding neighborhood continues to be very affluent today. The PM 2.5 is pretty similar across the county, no matter the grade, which leads me to believe it is bigger issue than the size of a census redlined region.\n\n# Part 2: Legacy of redlining in biodiversity observations\n\n## Import Data\n\n\n::: {.cell quiet='true'}\n\n```{.r .cell-code}\nbirds <- st_read(here(\"posts\",\"environmental_redlining\",\"data\", \"gbif-birds-LA\",\"gbif-birds-LA.shp\"))\n```\n:::\n\n\n## Summarize Data\n\n1.  Filter bird observations to the year 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbirds_2022 <- birds %>% \n  filter(year == 2022)\n```\n:::\n\n\n2.  Check if CRS's match between HOLC data and bird observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(st_crs(holc_transform) == st_crs(birds_2022)){\n  print(\"it's a match!\")\n} else {\n  print(\"not a match\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"not a match\"\n```\n:::\n\n```{.r .cell-code}\nbirds_transform <- st_transform(birds_2022, crs = st_crs(holc_transform))\n\nif(st_crs(holc_transform) == st_crs(birds_transform)){\n  print(\"it's a match!\")\n} else {\n  print(\"still not a match\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"it's a match!\"\n```\n:::\n:::\n\n\n3.  Join the bird observations and HOLC data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbird_holc <- st_join(holc_transform, birds_transform, join = st_intersects)\n\nbird_figure <- bird_holc %>% \n  group_by(grade) %>%\n  summarize(observation_percent = n()/nrow(bird_holc)*100) %>% \n  select(grade, observation_percent) %>% \n  st_drop_geometry()\n```\n:::\n\n\n4.  Produce bar plot that visualizes the HOLC grades against the bird observations.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nggplot(bird_figure) +\n  geom_col(aes(x = grade, y = observation_percent),\n           fill = c(\"palegreen3\", \"skyblue1\", \"lightgoldenrod\", \"tomato\", \"grey\")) +\n  labs(x = \"HOLC Grade\",\n       y = \"Observation of Birds (%)\",\n       title = \"Observation of Birds by HOLC Grades\")\n```\n\n::: {.cell-output-display}\n![](environmental_redlining_blog_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## Conclusion\n\nMy results do not align with the 'Bird Biodiversity Reports Reflect Cities' Redlined Past'. Unlike the paper, my bar plot shows that regions with an 'A' grade actually have the least amount of bird observations, and 'C' has the most. However, this makes sense because as seen in the earlier table, there are many more areas graded as 'C' compared to 'A', so there would be more birds seen in 'C'. If the bird observations were weighted based on the density of the grades, the plot might align more closely with the results of the article.\n\n# Data Citations\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Data </th>\n   <th style=\"text-align:left;\"> Citation </th>\n   <th style=\"text-align:left;\"> Link </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Global Biodiversity Information Facility </td>\n   <td style=\"text-align:left;\"> GBIF.org (13 October 2024) GBIF Occurence Download </td>\n   <td style=\"text-align:left;\"> [Species API](https://techdocs.gbif.org/en/openapi/v1/species) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> HOLC Redlining Data </td>\n   <td style=\"text-align:left;\"> Nelson, R. K., Winling, L, et al. (2023). Mapping Inequality: Redlining in New Deal America. Digital Scholarship Lab. https://dsl.richmond.edu/panorama/redlining. </td>\n   <td style=\"text-align:left;\"> [Mapping Inequality](https://dsl.richmond.edu/panorama/redlining/data) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> EJScreen: Environmental Justice Screening and Mapping Tool </td>\n   <td style=\"text-align:left;\"> United States Environmental Protection Agency. 2024 version. EJScreen. Retrieved: 10/4/24 from www.epa.gov/ejscreen </td>\n   <td style=\"text-align:left;\"> [EJScreen Data](https://www.epa.gov/ejscreen/download-ejscreen-data) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n",
    "supporting": [
      "environmental_redlining_blog_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}