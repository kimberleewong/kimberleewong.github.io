{
  "hash": "f89b238d5119a8873a60f9e5b323d44b",
  "result": {
    "markdown": "---\ntitle: \"Shifts in Geese Migration\"\ndescription: \"This project's goal is to determine whether geese migration distances are changing over time.\"\nauthor: \n  - name: Kimmy Wong \n    url: https://kimberleewong.github.io/\n    affiliation: MEDS \n    affiliation-url: https://bren.ucsb.edu/masters-programs/master-environmental-data-science\n    \ndate: 2024-12-13\ncategories: [r, MEDS, Statistics, Quarto]\ncitation: \n  url: https://kimberleewong.github.io/posts/thomas_fire_analysis/thomas-fire-blog.html\ntoc: true\nimage: geese_migration.avif\ndraft: false # prevents post from showing up until you are ready \n---\n\n\n# Shifts in Geese Migration\n\n![Hundreds of snow geese taking off for migration. Credits: Linda Davidson/The Washington Post](geese_migration.avif)\n\n## Motivate the Question\n\nHas geese migration distance changed over time?\n\nUnderstanding the relationship between climate variables and wildlife migration is critical in the context of climate change. Migratory species are often considered indicators of ecosystem health, as they are highly sensitive to environmental changes. Disruptions in their migration patterns could have cascading effects on biodiversity, ecosystem stability, and food webs. As climate change continues to alter temperature, precipitation, and other environmental variables, it is essential to investigate how these changes might influence migration behaviors, including distances traveled.\n\nPrevious studies have highlighted how factors like temperature and precipitation affect migration timing, routes, and destinations. These changes may lead to earlier or later migrations, altered paths, or shifts in wintering or breeding grounds. However, less attention has been given to changes in total migration distance, which could reflect significant shifts in species behavior or adaptations to changing conditions. Understanding migration distances over time is crucial, as it may offer insights into the energetic demands of migration, habitat availability, and the resilience of species to environmental stressors.\n\nMy goal in this analysis is to assess whether geese migration distances have changed over time and to examine the potential influence of precipitation as a key climate variable. By analyzing data on migration distances from specific years and integrating climatic data where available, I aim to uncover patterns or trends that might signal broader ecological shifts.\n\nAdditionally, this study acknowledges some challenges, such as gaps in data across years and potential biases in sample sizes for certain time periods. Recognizing these limitations, the analysis will employ statistical methods like linear regression to evaluate trends and consider the potential impact of precipitation on migration distances. With a better understanding of these patterns, we can contribute to broader efforts to monitor the effects of climate change on migratory species and their ecosystems.\n\n## Hypotheses\n\nBased on previous research that describes how environmental factors can influence migration patterns, I believe that there will be a change in geese migration over time. Below shows a table of my two hypotheses, and I will be attempting to determine whether or not they can be rejected.\n\n| Hypothesis: There is a change in geese migration distance over time.       |\n|------------------------------------------------------------------------|\n| Null hypothesis: There is no change in geese migration distance over time. |\n\n## Analysis Plan\n\n1.  Load in data\n2.  Clean and manipulate data\n3.  Create boxplots to visualize distribution\n4.  Run linear regression model\n5.  Visualize linear regression\n6.  Analyze results\n\n## Data\n\nMy data comes from Movebank, a free online database that houses a vast collection of animal tracking data contributed by researchers worldwide. Movebank offers a unique opportunity to study wildlife movement patterns by providing detailed spatial and temporal data for a wide variety of species. My professor, Max Czapanskiy, played a significant role in helping me identify this dataset, exploring the repository to find a species with a consistent and well-documented migration pattern. We settled on geese because their predictable and regular migratory behavior makes them an ideal subject for studying trends over time.\n\nThe dataset I selected was originally created for a paper investigating the timing of geese migrations over a time span covering 2006 to 2009, followed by a three-year gap, and then 2013 and 2014. The data include 65 geese that were tagged and tracked across their migration routes, providing information on their movements throughout the year. This spatial data was meticulously documented in the original study, and it includes a visualization of the geese's migration routes and stopover locations, which helped to inform my understanding of their migration patterns. The following graph comes from their paper.\n\n![Migration tracks. Credits: Kölzsch et al., 2016](geese_paper.png)\n\nFor my original project proposal, I aimed to build upon the original dataset by incorporating an additional environmental predictor variable---precipitation. I sourced precipitation data from NOAA, selecting a weather station located along the geese's migration route. My hope was to explore whether precipitation levels might influence migration distances in any meaningful way. However, as I later discovered, the inclusion of this variable presented challenges. The spatial and temporal aspects of the precipitation data did not align well with the migration data, limiting its utility in the analysis.\n\n## Analysis\n\n### Load in Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at /Users/kjwong/MEDS/kimberleewong.github.io\n```\n:::\n\n```{.r .cell-code}\nlibrary(tmap)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'tmap'\n\nThe following object is masked from 'package:datasets':\n\n    rivers\n```\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(modelr)\nlibrary(broom)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'broom'\n\nThe following object is masked from 'package:modelr':\n\n    bootstrap\n```\n:::\n:::\n\n\n### Import Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Movebank geese data\ngeese <- read_sf(here(\"posts/geese_migration/data/Migration timing in white-fronted geese (data from Klzsch et al. 2016)/points.shp\"))\n\n# NOAA precipitation data\nprecip <- read_csv(here(\"posts/geese_migration/data/precip.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 3287 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): STATION, NAME\ndbl  (5): LATITUDE, LONGITUDE, ELEVATION, PRCP, SNWD\ndate (1): DATE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\n### Clean Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add year column to both datasets\ngeese$year <- year(geese$timestamp)\n\nprecip$year <- year(precip$DATE)\n\n# Filter precipitation data to years we have data for geese\nprecip <- precip[precip$year %in% c(2006, 2007, 2008, 2009, 2013, 2014), ]\n\n# Create new dataset that has the average precipitation per year\nmean_precip <- precip %>%\n  group_by(year) %>%\n  summarise(mean_precip = mean(PRCP, na.rm = TRUE))\n```\n:::\n\n\n### Filter for Box Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create new dataframes for each year, so we can make a boxplot for each year\nearly_2006 <- geese %>% \n  filter(year == 2006)\n\nearly_2007 <- geese %>% \n  filter(year == 2007)\n\nearly_2008 <- geese %>% \n  filter(year == 2008)\n\nearly_2009 <- geese %>% \n  filter(year == 2009)\n\nlate_2013 <- geese %>% \n  filter(year == 2013)\n\nlate_2014 <- geese %>% \n  filter(year == 2014)\n```\n:::\n\n\n### Calculate Maximum Distance\n\nIn order to make a linear regression model and visualize how migration distances are changing year to year, we're going to create a new variable. By grouping by tag_ident (which is unique to each goose) and year, and using the max of st_distance, we can measure the distance between the two farthest points where a goose had been tagged that year. We will do this to the entire dataframe and to each year in order to make the boxplots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngeese_group <- geese %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2006 <- early_2006 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2007 <- early_2007 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2008 <- early_2008 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2009 <- early_2009 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2013 <- late_2013 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ngeese_2014 <- late_2014 %>% \n  group_by(tag_ident, year) %>% \n  summarise(\n    max_distance = max(st_distance(geometry, geometry), na.rm = TRUE)\n  ) %>% \n  ungroup() %>% \n  mutate(max_distance = as.numeric(max_distance))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'tag_ident'. You can override using the\n`.groups` argument.\n```\n:::\n:::\n\n\n### Box Plot Visualizations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set y_limits so each y-axis is the same, and it is easier to compare\ny_limits <- range(geese_group$max_distance, na.rm = TRUE)\n\nb2006 <- ggplot(geese_2006, aes(x = \"2006\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  scale_y_continuous(limits = y_limits) +\n  labs(y = \"Distance (meters)\") +\n    theme(axis.title.x = element_blank())  # Turn off x-axis label\n   \n\nb2007 <- ggplot(geese_2007, aes(x = \"2007\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  scale_y_continuous(limits = y_limits) +\n    theme(\n    axis.title.x = element_blank(),  # Turn off x-axis label\n    axis.title.y = element_blank())\n\nb2008 <- ggplot(geese_2008, aes(x = \"2008\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3)  +\n  scale_y_continuous(limits = y_limits) +\n    theme(\n    axis.title.x = element_blank(),  # Turn off x-axis label\n    axis.title.y = element_blank())\n\nb2009 <- ggplot(geese_2009, aes(x = \"2009\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  scale_y_continuous(limits = y_limits) +\n    theme(\n    axis.title.x = element_blank(),  # Turn off x-axis label\n    axis.title.y = element_blank())\n\nb2013 <- ggplot(geese_2013, aes(x = \"2013\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  scale_y_continuous(limits = y_limits) +\n    theme(\n    axis.title.x = element_blank(),  # Turn off x-axis label\n    axis.title.y = element_blank())\n\nb2014 <- ggplot(geese_2014, aes(x = \"2014\", y = max_distance)) +\n  geom_boxplot() +\n  stat_summary(fun = mean, geom = \"point\", color = \"red\", size = 3) +\n  scale_y_continuous(limits = y_limits) +\n    theme(\n    axis.title.x = element_blank(),  # Turn off x-axis label\n    axis.title.y = element_blank())\n\n(b2006 | b2007 | b2008 | b2009 | b2013 | b2014) + \n  plot_annotation(\n  title = \"Yearly Distribution of Maximum Migration Distances of Geese\")\n```\n\n::: {.cell-output-display}\n![](geese_migration_blog_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nIn these box plots the red dot represents the mean. There is noticeable variability in migration distances across years. Some years, 2007 and 2008, have larger interquartile ranges, while others, 2013, have more tightly clustered data. The 2014 data appears to have a few outliers on the lower end.\n\n### Linear Regression Model (Year only)\n\nFor the first linear regression model, I'm only gonna run the year as the predictor.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear_mod <- lm(max_distance ~ year, geese_group)\n\nggplot(geese_group, aes(x = year,\n                  y = max_distance)) +\n  geom_point() +\n  geom_smooth(se = FALSE,\n              method = lm) +\n  theme(aspect.ratio = 1) + \n  labs(title = \"Linear Regression Model of Maximum Migration for Geese\",\n       x = \"Year\",\n       y = \"Max Distance (meters)\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](geese_migration_blog_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(year_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = max_distance ~ year, data = geese_group)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2030506  -282246    39621   245984  2060253 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)\n(Intercept) -29660636   66157768  -0.448    0.655\nyear            16140      32888   0.491    0.625\n\nResidual standard error: 851300 on 75 degrees of freedom\nMultiple R-squared:  0.003201,\tAdjusted R-squared:  -0.01009 \nF-statistic: 0.2409 on 1 and 75 DF,  p-value: 0.625\n```\n:::\n:::\n\n\nAfter looking at both the results of the visualization and the summary of the model, it is very much inconclusive. While the graph seems to show an increase in maximum migration distances (albeit very slight), the summary shows that the p-value for the year predictor is 0.625. This is much too high for this variable to be considered signficant. In addition to this, the R-squared value is 0.0032, and this means that the model explains only 0.32% of the variability in migration distances.\n\n### Plot Residuals\n\nLet's plot the residuals to see if there are any blaring red flags about this choice of model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(geese_group, aes(x = year, y = resid(year_mod))) +\n  geom_point() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(title = \"Residuals of the Linear Model\",\n       x = \"Year\",\n       y = \"Residuals\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](geese_migration_blog_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nThe residuals appear to be randomly distributed along the x-axis (years). This suggests that the relationship between predictors and the response variable is reasonably linear. There seem to be clusters of residuals near certain years, which is likely due to an uneven distribution of data across years. There are residuals that are very large, and these could be outliers.\n\n### Add Precipitation to Model\n\nLet's try adding precipitation to the model to see if we can get a more significant relationship.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged_data <- merge(geese_group, mean_precip, by = \"year\", all.x = TRUE)\n\n# Make year variable is treated as a categorical variable\nmerged_data <- merged_data %>% mutate(year = as.factor(year)) \n\nprecip_mod <- lm(max_distance ~ mean_precip + year, data = merged_data)\n\nsummary(precip_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = max_distance ~ mean_precip + year, data = merged_data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2139000  -216127    17442   295893  1746955 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  7510783    5128234   1.465    0.147\nmean_precip -1812342    2057486  -0.881    0.381\nyear2007     -131332     443555  -0.296    0.768\nyear2008      113113     488158   0.232    0.817\nyear2009     -801156     751133  -1.067    0.290\nyear2013     -148566     297875  -0.499    0.619\nyear2014          NA         NA      NA       NA\n\nResidual standard error: 852700 on 71 degrees of freedom\nMultiple R-squared:  0.05328,\tAdjusted R-squared:  -0.01339 \nF-statistic: 0.7992 on 5 and 71 DF,  p-value: 0.5539\n```\n:::\n:::\n\n\nUnfortunately, even after precipitation to the model, none of the predictors' p-values are small enough to be considered signficant. While the R-squared did increase quite a bit, the adjusted R-squared was practically unchanged.\n\n## Conclusion\n\nTo sum up our results, in both linear models (first: year as only predictor, second: year as a categorical predictor and mean precipitation as a continous one) there is no significant p-value found. In the first model, the p-value for year as a predictor was 0.625, indicating a 62.5% chance that the result was due to chance. The second model similarly shows p-values that are too high. As a result, I cannot reject the null hypothesis. There are a few possibilities to why this outcme could have occurred. Below describes the limitations of the data. The box plots that were created do show variability throughout the years in maximum migration distance, but a confident relationship cannot be determined.\n\n### Limitations of the Data\n\nWhile the dataset from Movebank offers valuable insights into geese migration patterns, several limitations must be acknowledged, as they could affect the robustness and interpretation of the analysis:\n\n1.  Temporal Gaps in the Data The dataset spans 2006 to 2009 and then skips three years before resuming for 2013 and 2014. This temporal gap introduces potential biases, as it excludes data from years that might have exhibited different migration behaviors due to environmental or ecological changes. Consequently, the uneven time distribution reduces the ability to assess continuous trends over time.\n\n2.  Uneven Sample Size Across Years The number of geese tracked varies significantly between years, leading to imbalances in the dataset. This uneven distribution may skew the results, as years with fewer data points have less statistical weight, potentially masking real patterns or exaggerating anomalies in years with more extensive data coverage.\n\n3.  Lack of Comprehensive Environmental Variables While the inclusion of precipitation data was a step toward understanding environmental influences, the variable proved challenging to integrate effectively. The NOAA station data was limited in its spatial relevance to the geese's migration routes and lacked temporal precision. Other critical environmental factors, such as temperature, wind patterns, or habitat changes along the migration path, were not included, which limits the ability to fully understand the drivers behind migration distances.\n\n4.  Potential Impact of External Factors The original study mentioned that some geese were lost during hunting seasons. This human-induced mortality could affect migration data by reducing sample sizes or influencing the observed migration distances of tagged individuals.\n\n5.  Simplification of Migration Distance Calculation The migration distance was calculated as the maximum distance traveled by each goose during the year, assuming that this represented the total migration length. This approach does not account for potential deviations, stopovers, or detours in the migration path, which might lead to underestimation or overestimation of actual migration effort.\n\n6.  Bias Toward Surviving Individuals The data inherently focuses on geese that completed their migrations and excludes individuals that may have died en route or failed to migrate. This survivorship bias could paint an incomplete picture of the migration patterns and the challenges faced by the population.\n\n7.  Limited Geographic and Population Scope The dataset tracks a specific subset of the goose population in a defined geographic area. Findings from this subset may not be generalizable to other populations or regions where geese face different environmental pressures or migratory challenges.\n\nAcknowledging these limitations is essential for interpreting the results and framing conclusions. Future studies could aim to fill data gaps, integrate additional environmental variables, and explore alternative methods for calculating migration distances to gain a more comprehensive understanding of the factors influencing geese migration.\n\n## References\n\n| Data:                | Citation:                                                                                                                                                                                                                                                                                                                                         |\n|------------------|------------------------------------------------------|\n| Geese Migration Data | Kölzsch, A., Müskens, G. J. D. M., Kruckenberg, H., Glazov, P., Weinzierl, R., Nolet, B. A., & Wikelski, M. (2016). Towards a new understanding of migration timing: slower spring than autumn migration in geese reflects different decision rules for stopover use and departure. Oikos, 125(10), 1496--1507. https://doi.org/10.1111/oik.03121 |\n| Precipitation Data   | Climate Data Online (CDO), National Climatic Data Center (NCDC). (n.d.). Www.ncei.noaa.gov. https://www.ncei.noaa.gov/cdo-web/search                                                                                                                                                                                                              |\n",
    "supporting": [
      "geese_migration_blog_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}